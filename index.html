<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <title>RPGym</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- Bootstrap -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
            integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
            crossorigin="anonymous"
        ></script>

        <!-- Font Awesome -->
        <script
            src="https://kit.fontawesome.com/d1a66f824f.js"
            crossorigin="anonymous"
        ></script>

        <style>
            .progress {
                height: 22px;
            }

            .progress-bar {
                font-weight: bold;
            }

            #view-login h2 {
                letter-spacing: 1px;
            }

            #authCard.register-mode {
                border-top: 3px solid #0d6efd;
                padding-top: 10px;
            }

            #authCard.register-mode h5 {
                color: #0d6efd;
            }
        </style>
    </head>

    <body class="d-flex flex-column min-vh-100">
        <!-- ================= LOGIN ================= -->
        <div
            id="view-login"
            class="d-flex justify-content-center align-items-center vh-100 bg-dark"
        >
            <div class="card p-4" style="max-width: 380px; width: 100%">
                <img
                    src="./assets/RPGym_logo.jpg"
                    class="card-img-top"
                    alt="Logo"
                />

                <!-- LOGIN SOCIAL -->
                <button
                    id="btnGoogleLogin"
                    class="btn btn-secondary w-100 mb-2 mt-2"
                >
                    <i class="fa-brands fa-google me-2"></i>
                    Continuar con Google
                </button>

                <button
                    id="btnFacebookLogin"
                    class="btn btn-primary w-100 mb-3"
                    style="display: none"
                >
                    <i class="fa-brands fa-facebook me-2"></i>
                    Continuar con Facebook
                </button>

                <div class="text-center text-muted mb-3">o</div>

                <!-- FORM EMAIL / PASSWORD -->
                <div id="authCard">
                    <h5 id="authTitle" class="text-center mb-3">
                        Iniciar sesi√≥n
                    </h5>

                    <input
                        type="email"
                        id="email"
                        class="form-control mb-2"
                        placeholder="Correo electr√≥nico"
                    />

                    <input
                        type="password"
                        id="password"
                        class="form-control mb-2"
                        placeholder="Contrase√±a"
                    />

                    <!-- SOLO REGISTRO -->
                    <input
                        type="password"
                        id="passwordConfirm"
                        class="form-control mb-2 d-none"
                        placeholder="Confirmar contrase√±a"
                    />

                    <button id="btnPrimary" class="btn btn-success w-100 mb-2">
                        Iniciar sesi√≥n
                    </button>

                    <button
                        id="btnToggleMode"
                        class="btn btn-link w-100"
                        type="button"
                    >
                        ¬øNo tienes cuenta? Crear una
                    </button>
                </div>
            </div>
        </div>

        <!-- ================= Navbar ================= -->
        <div id="app-navbar" class="d-none">
            <nav class="navbar navbar-expand-lg bg-light">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#" id="navDashboard">RPGym</a>

                    <button
                        class="navbar-toggler"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#navbarTogglerDemo02"
                        aria-controls="navbarTogglerDemo02"
                        aria-expanded="false"
                        aria-label="Toggle navigation"
                    >
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div
                        class="collapse navbar-collapse"
                        id="navbarTogglerDemo02"
                    >
                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                            <li class="nav-item">
                                <a class="nav-link" href="#" id="navAsistencia"
                                    >Asistencia</a
                                >
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" id="navFuerza"
                                    >Fuerza</a
                                >
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" id="navPeso"
                                    >Peso</a
                                >
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" id="navPremios"
                                    >Premios</a
                                >
                            </li>
                        </ul>

                        <button class="btn btn-outline-danger" id="btnLogout">
                            <i class="fa-solid fa-right-from-bracket"></i>
                            Logout
                        </button>
                    </div>
                </div>
            </nav>
        </div>

        <!-- ================= DASHBOARD ================= -->
        <div id="view-dashboard" class="d-none px-2 px-md-5">
            <h4 class="mb-3">
                <i class="fa-solid fa-gauge-high me-2"></i>
                Dashboard
            </h4>

            <div class="row g-3 align-items-stretch">
                <!-- XP -->
                <div class="col-md-3 d-flex">
                    <div class="card w-100 p-3 text-center flex-fill">
                        <i class="fa-solid fa-star fa-2x text-warning mb-2"></i>
                        <h6>XP Total</h6>
                        <strong id="dashXP">0</strong>

                        <ul class="mt-2 small">
                            <li>
                                Asistencia: <span id="xpAsistencia">0</span>
                            </li>
                            <li>Fuerza: <span id="xpFuerza">0</span></li>
                            <li>Peso: <span id="xpPeso">0</span></li>
                        </ul>
                    </div>
                </div>

                <!-- Asistencias -->
                <div class="col-md-3 d-flex">
                    <div class="card w-100 p-3 text-center">
                        <i
                            class="fa-solid fa-calendar-check fa-2x text-success mb-2"
                        ></i>
                        <h6>Asistencias</h6>
                        <strong id="dashAsistencias">0</strong>
                    </div>
                </div>

                <!-- Nivel fuerza actual -->
                <div class="col-md-3 d-flex">
                    <div class="card w-100 p-3 text-center flex-fill">
                        <i
                            class="fa-solid fa-dumbbell fa-2x text-primary mb-2"
                        ></i>

                        <h6>Nivel actual de fuerza:</h6>
                        <strong id="dashNivelFuerza">-</strong>
                    </div>
                </div>

                <!-- Peso inicial -->
                <div class="col-md-3 d-flex">
                    <div class="card w-100 p-3 text-center flex-fill">
                        <i
                            class="fa-solid fa-flag fa-2x text-secondary mb-2"
                        ></i>
                        <h6>Peso inicial</h6>
                        <strong id="dashPesoInicial">-</strong>
                    </div>
                </div>

                <!-- Peso actual -->
                <div class="col-md-3 d-flex">
                    <div class="card w-100 p-3 text-center flex-fill">
                        <i
                            class="fa-solid fa-weight-scale fa-2x text-primary mb-2"
                        ></i>
                        <h6>Peso actual</h6>
                        <strong id="dashPesoActual">-</strong>
                    </div>
                </div>
            </div>
        </div>

        <!-- ================= ASISTENCIA ================= -->
        <div id="view-asistencia" class="d-none px-2 px-md-5">
            <div class="card p-3 mb-3" id="card-asistencia">
                <h5 class="mb-3">
                    <i class="fa-solid fa-calendar-check me-2 text-success"></i>
                    Asistencia semanal
                </h5>

                <p class="mb-1">
                    Progreso de misi√≥n:
                    <strong id="asistenciaTexto">0 / 5</strong>
                </p>

                <div class="progress mb-3">
                    <div
                        id="asistenciaBar"
                        class="progress-bar bg-success"
                        style="width: 0%"
                    >
                        0%
                    </div>
                </div>

                <button
                    id="btnRegistrarAsistencia"
                    class="btn btn-success w-100"
                >
                    <i class="fa-solid fa-check me-2"></i>
                    Registrar asistencia de hoy
                </button>

                <div
                    id="asistenciaYaRegistrada"
                    class="text-muted text-center d-none mt-2"
                >
                    ‚úÖ Asistencia de hoy ya registrada
                </div>
            </div>
        </div>

        <!-- ================= FUERZA ================= -->
        <div id="view-fuerza" class="container mt-4 d-none">
            <!-- HEADER -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div class="row w-100">
                    <div class="col-12">
                        <h4 class="mb-0 text-center">
                            <i
                                class="fa-solid fa-dumbbell me-2 text-primary"
                            ></i>
                            Progreso de Fuerza
                        </h4>
                    </div>
                    <div class="col-12 text-center">
                        <button
                            id="btnAddExercise"
                            class="btn btn-primary mt-2"
                            type="button"
                        >
                            <i class="fa-solid fa-plus me-1"></i>
                            Agregar ejercicio
                        </button>
                    </div>
                </div>
            </div>

            <!-- M√âTRICAS DE FUERZA -->
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="card p-3 border-primary">
                        <h6 class="mb-1">üèãÔ∏è Nivel de Fuerza</h6>
                        <p class="mb-0">
                            Nivel actual:
                            <strong id="nivelFuerzaBase">0</strong>
                        </p>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card p-3 border-success">
                        <h6 class="mb-1">üìà Progreso de Fuerza</h6>
                        <p class="mb-0">
                            Nivel de progreso:
                            <strong id="nivelFuerzaProgreso">0</strong>
                        </p>
                    </div>
                </div>
            </div>

            <!-- LISTA DE EJERCICIOS -->
            <div id="exerciseList" class="row g-3">
                <!-- Cards din√°micas desde fuerza.js -->
            </div>
        </div>

        <!-- =========================
            MODAL: AGREGAR EJERCICIO
        ========================= -->
        <div
            class="modal fade"
            id="modalExercise"
            tabindex="-1"
            aria-hidden="true"
        >
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <!-- HEADER -->
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fa-solid fa-dumbbell me-2"></i>
                            Agregar ejercicio
                        </h5>
                        <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Cerrar"
                        ></button>
                    </div>

                    <!-- BODY -->
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label"> Ejercicio </label>
                            <select id="exerciseSelect" class="form-select">
                                <!-- Opciones desde cat_ejercicios -->
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">
                                Peso inicial (kg)
                            </label>
                            <input
                                type="number"
                                id="exerciseWeight"
                                class="form-control"
                                placeholder="Ej. 40"
                                min="0"
                                step="0.5"
                            />
                        </div>
                    </div>

                    <!-- FOOTER -->
                    <div class="modal-footer">
                        <button
                            type="button"
                            class="btn btn-outline-secondary"
                            data-bs-dismiss="modal"
                        >
                            Cancelar
                        </button>

                        <button
                            type="button"
                            id="btnSaveExercise"
                            class="btn btn-primary"
                        >
                            Guardar ejercicio
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- PESO -->
        <div id="view-peso" class="d-none px-2 px-md-5">
            <h4 class="mb-3">
                <i class="fa-solid fa-weight-scale me-2"></i>
                Progreso de Peso
            </h4>

            <!-- Barra RPG -->
            <small class="text-muted"> Progreso hacia tu peso objetivo </small>
            <div class="progress mb-3">
                <div id="weightBar" class="progress-bar" style="width: 0%">
                    0 kg
                </div>
            </div>

            <div class="card p-3 mb-3">
                <label class="form-label">
                    <i class="fa-solid fa-bullseye me-2"></i>
                    Peso objetivo (kg)
                </label>

                <div class="input-group">
                    <input
                        type="number"
                        step="0.1"
                        id="pesoObjetivoInput"
                        class="form-control"
                        placeholder="Ej. 80"
                    />
                    <button
                        class="btn btn-outline-primary"
                        id="btnGuardarPesoObjetivo"
                    >
                        Guardar
                    </button>
                </div>
            </div>

            <button class="btn btn-primary w-100 mb-3" id="btnRegistrarPeso">
                <i class="fa-solid fa-plus me-2"></i>
                Registrar peso
            </button>

            <!-- Historial -->
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th>Fecha</th>
                        <th>Peso (kg)</th>
                        <th class="text-end">Acciones</th>
                    </tr>
                </thead>
                <tbody id="weightTable"></tbody>
            </table>
        </div>

        <!-- ========================= VISTA: PREMIOS ========================= -->
        <div id="view-premios" class="container mt-4 d-none">
            <!-- HEADER -->
            <div class="mb-4">
                <h4 class="mb-1">
                    <i class="fa-solid fa-gift me-2 text-warning"></i>
                    Premios
                </h4>
                <p class="text-muted mb-0">
                    Recompensas reales que te has ganado con tu esfuerzo
                </p>
            </div>

            <!-- RESUMEN POR CATEGOR√çA -->
            <div class="row g-3 mb-4">
                <div class="col-md-4">
                    <div class="card p-3 h-100 border-primary">
                        <h6>
                            <i class="fa-solid fa-calendar-check me-2"></i>
                            Asistencia
                        </h6>
                        <p class="mb-1">
                            Nivel actual:
                            <strong id="nivelAsistencia">‚Äì</strong>
                        </p>
                        <p class="mb-0 text-muted">
                            Pr√≥ximo premio:
                            <span id="nextRewardAsistencia">‚Äì</span>
                        </p>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card p-3 h-100 border-success">
                        <h6>
                            <i class="fa-solid fa-dumbbell me-2"></i>
                            Fuerza
                        </h6>
                        <p class="mb-1">
                            Nivel actual: <strong id="nivelFuerza">‚Äì</strong>
                        </p>
                        <p class="mb-0 text-muted">
                            Pr√≥ximo premio:
                            <span id="nextRewardFuerza">‚Äì</span>
                        </p>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card p-3 h-100 border-warning">
                        <h6>
                            <i class="fa-solid fa-weight-scale me-2"></i>
                            Peso
                        </h6>
                        <p class="mb-1">
                            Nivel actual: <strong id="nivelPeso">‚Äì</strong>
                        </p>
                        <p class="mb-0 text-muted">
                            Pr√≥ximo premio:
                            <span id="nextRewardPeso">‚Äì</span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- HISTORIAL DE PREMIOS -->
            <div class="card p-3">
                <h5 class="mb-3">
                    <i class="fa-solid fa-trophy me-2 text-warning"></i>
                    Historial de premios
                </h5>

                <div id="rewardHistory">
                    <p class="text-muted mb-0">
                        A√∫n no has registrado ning√∫n premio.
                    </p>
                </div>
            </div>
        </div>

        <!-- ========================= MODAL: PREMIO DESBLOQUEADO ========================= -->
        <div
            class="modal fade"
            id="rewardModal"
            tabindex="-1"
            data-bs-backdrop="static"
            data-bs-keyboard="false"
        >
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <!-- HEADER -->
                    <div class="modal-header">
                        <h5 class="modal-title">üéâ Premio desbloqueado</h5>
                    </div>

                    <!-- BODY -->
                    <div class="modal-body">
                        <p id="rewardInfo" class="mb-3">
                            <!-- Texto din√°mico -->
                        </p>

                        <label class="form-label">
                            ¬øQu√© recompensa te diste?
                        </label>

                        <input
                            type="text"
                            id="rewardName"
                            class="form-control"
                            placeholder="Ej. Aud√≠fonos nuevos"
                        />
                    </div>

                    <!-- FOOTER -->
                    <div class="modal-footer">
                        <button
                            id="btnSaveReward"
                            class="btn btn-success w-100"
                        >
                            Guardar premio
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script type="module" src="js/firebase.js"></script>
        <script type="module" src="js/auth.js"></script>
        <script type="module" src="js/base.js"></script>
        <script type="module" src="js/asistencia.js"></script>
        <script type="module" src="js/fuerza.js"></script>
        <script type="module" src="js/peso.js"></script>
        <script type="module" src="js/premios.js"></script>
    </body>
</html>
